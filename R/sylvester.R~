sylvester <-
function(A, E, C, cond.number = FALSE)
{
    dA <- dim(A)
    dB <- dim(B)
    dE <- dim(E)
    dd <- c(dA,dB,dE)
    if((max(dd)-min(dd))==0)
       stop('A,B,C must be square matrix')
    if(cond.number)
        ierr = 1
    else
        ierr = 0
    
    N     <- NAE <- NC <- dd[1]
    WKV   <- rep(0, 2*N^2+3*N)
    RCOND <- 0
    out <- .Fortran('SYLGD', as.integer(NAE), as.integer(NC), as.integer(N),
                      as.double(A), as.double(E), as.double(C),
                      as.double(WKV), as.integer(RCOND), as.integer(ierr))
    matrix(out[[6]], N, N)
}

